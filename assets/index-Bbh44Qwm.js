const C=/#/g,p=/&/g,O=/\//g,P=/=/g,f=/\+/g,I=/%5e/gi,S=/%60/gi,T=/%7c/gi,w=/%20/gi;function N(t){return encodeURI(""+t).replace(T,"|")}function i(t){return N(typeof t=="string"?t:JSON.stringify(t)).replace(f,"%2B").replace(w,"+").replace(C,"%23").replace(p,"%26").replace(S,"`").replace(I,"^").replace(O,"%2F")}function a(t){return i(t).replace(P,"%3D")}function E(t=""){try{return decodeURIComponent(""+t)}catch{return""+t}}function Q(t){return E(t.replace(f," "))}function b(t){return E(t.replace(f," "))}function U(t=""){const e={};t[0]==="?"&&(t=t.slice(1));for(const o of t.split("&")){const r=o.match(/([^=]+)=?(.*)/)||[];if(r.length<2)continue;const n=Q(r[1]);if(n==="__proto__"||n==="constructor")continue;const c=b(r[2]||"");e[n]===void 0?e[n]=c:Array.isArray(e[n])?e[n].push(c):e[n]=[e[n],c]}return e}function j(t,e){return(typeof e=="number"||typeof e=="boolean")&&(e=String(e)),e?Array.isArray(e)?e.map(o=>`${a(t)}=${i(o)}`).join("&"):`${a(t)}=${i(e)}`:a(t)}function $(t){return Object.keys(t).filter(e=>t[e]!==void 0).map(e=>j(e,t[e])).filter(Boolean).join("&")}const x=/^[\s\w\0+.-]{2,}:([/\\]{1,2})/,G=/^[\s\w\0+.-]{2,}:([/\\]{2})?/,H=/^([/\\]\s*){2,}[^/\\]/,W=/\/$|\/\?|\/#/,B=/^\.?\//;function m(t,e={}){return typeof e=="boolean"&&(e={acceptRelative:e}),e.strict?x.test(t):G.test(t)||(e.acceptRelative?H.test(t):!1)}function h(t="",e){return e?W.test(t):t.endsWith("/")}function K(t="",e){if(!e)return(h(t)?t.slice(0,-1):t)||"/";if(!h(t,!0))return t||"/";let o=t,r="";const n=t.indexOf("#");n>=0&&(o=t.slice(0,n),r=t.slice(n));const[c,...s]=o.split("?");return((c.endsWith("/")?c.slice(0,-1):c)||"/")+(s.length>0?`?${s.join("?")}`:"")+r}function v(t="",e){if(!e)return t.endsWith("/")?t:t+"/";if(h(t,!0))return t||"/";let o=t,r="";const n=t.indexOf("#");if(n>=0&&(o=t.slice(0,n),r=t.slice(n),!o))return r;const[c,...s]=o.split("?");return c+"/"+(s.length>0?`?${s.join("?")}`:"")+r}function J(t,e){if(D(e)||m(t))return t;const o=K(e);return t.startsWith(o)?t:V(o,t)}function z(t,e){const o=y(t),r={...U(o.search),...e};return o.search=$(r),X(o)}function D(t){return!t||t==="/"}function M(t){return t&&t!=="/"}function V(t,...e){let o=t||"";for(const r of e.filter(n=>M(n)))if(o){const n=r.replace(B,"");o=v(o)+n}else o=r;return o}const g=Symbol.for("ufo:protocolRelative");function y(t="",e){const o=t.match(/^[\s\0]*(blob:|data:|javascript:|vbscript:)(.*)/i);if(o){const[,u,R=""]=o;return{protocol:u.toLowerCase(),pathname:R,href:u+R,auth:"",host:"",search:"",hash:""}}if(!m(t,{acceptRelative:!0}))return e?y(e+t):_(t);const[,r="",n,c=""]=t.replace(/\\/g,"/").match(/^[\s\0]*([\w+.-]{2,}:)?\/\/([^/@]+@)?(.*)/)||[],[,s="",l=""]=c.match(/([^#/?]*)(.*)?/)||[],{pathname:A,search:L,hash:d}=_(l.replace(/\/(?=[A-Za-z]:)/,""));return{protocol:r.toLowerCase(),auth:n?n.slice(0,Math.max(0,n.length-1)):"",host:s,pathname:A,search:L,hash:d,[g]:!r}}function _(t=""){const[e="",o="",r=""]=(t.match(/([^#?]*)(\?[^#]*)?(#.*)?/)||[]).splice(1);return{pathname:e,search:o,hash:r}}function X(t){const e=t.pathname||"",o=t.search?(t.search.startsWith("?")?"":"?")+t.search:"",r=t.hash||"",n=t.auth?t.auth+"@":"",c=t.host||"";return(t.protocol||t[g]?(t.protocol||"")+"//":"")+n+c+e+o+r}export{J as a,$ as s,z as w};
