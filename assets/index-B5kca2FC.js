import{f as Ue,b as Re}from"./formatters-zPA0pF4b.js";import{r as D,a as se,o as v,f as B,e as t,b as e,a2 as r,t as x,d as s,m as l,a3 as J,aV as fe,c as b,y as q,am as ie,F as S,h as T,v as $,q as ve,i as he,J as K,K as W,aO as j,x as ae,aW as Te,a9 as Q,w as Be,I as Pe}from"./index-VU0dmoHZ.js";import{_ as xe}from"./MoreBtn-DFEYxWak.js";import{P as ue}from"./vue3-perfect-scrollbar.esm-CKkShybS.js";import{I as ke,L as be}from"./index-Ce2FQ3QQ.js";import{u as ye,S as $e,P as Ce,U as we,E as Ve}from"./index-M7Yum2cK.js";import{a as Ne,b as Oe,V as ne}from"./VCard-DttbPEhw.js";import{V as X}from"./VTextField-CRe8TF0Y.js";import{V as R}from"./VDivider-BdZVMXth.js";import{V as Y}from"./VMenu-DngO4Bzq.js";import{V as Z,a as ee,b as oe}from"./VList-DhXfVcoA.js";import{V as G}from"./VSpacer-DIW3Gp5e.js";import{V as me}from"./VBadge-gIlJ6WRl.js";import{$ as ge}from"./api-Cp89FJ6x.js";import{V as Fe}from"./VChip-ClWrs_JY.js";import{V as U}from"./VTooltip-B61Kcv-O.js";import{V as le}from"./VCardText-uyCvIofY.js";import{V as Le}from"./VAvatar-B0yljh3k.js";import{V as de}from"./VImg-BNqJuZG0.js";import{V as Me}from"./VNavigationDrawer-Dm7lBkUR.js";import{u as je,V as qe,a as He}from"./VMain-G98gMn7d.js";import{u as Je}from"./useApi-DHFWqMSv.js";import{c as Ke}from"./createUrl-BhvyS9BG.js";import{V as _e}from"./VCheckbox-DXvPyzAP.js";import"./helpers-DK5QwNv0.js";/* empty css                   */import"./VCounter-BnJ4X-op.js";import"./VField-TfdV7Sv1.js";import"./form-D37_K2HO.js";import"./easing-CjukEv2V.js";import"./VInput-DUnqEF-j.js";import"./forwardRefs-C-GTDzx5.js";import"./VOverlay-BZO4hDjN.js";import"./lazy-CTD-MLkl.js";import"./scopeId-DwszM4ys.js";import"./dialog-transition-ClMl6VK0.js";import"./ssrBoot-Cx7lQdW-.js";/* empty css              */import"./index-Bbh44Qwm.js";import"./VSlideGroup-CNt9oOkj.js";import"./VCheckboxBtn-DGugApLE.js";import"./VSelectionControl-Dht4FwVx.js";const We={class:"pe-5"},Ge=s("div",{class:"text-body-1 text-disabled font-weight-medium"}," To: ",-1),Qe={class:"d-flex text-body-1 cursor-pointer text-medium-emphasis"},Xe=s("div",{class:"mx-1"},"|",-1),Ye={key:0},Ze=s("div",{class:"text-body-1 text-disabled font-weight-medium"}," Cc: ",-1),et={key:0},tt=s("div",{class:"text-body-1 text-disabled font-weight-medium"}," Bcc: ",-1),lt=s("div",{class:"text-body-1 text-disabled font-weight-medium"}," Subject: ",-1),at={class:"tiptap-editor-wrapper"},it={key:0,class:"d-flex flex-wrap gap-x-1 px-4 py-2"},nt={class:"mx-5"},ot={class:"d-flex align-center px-5 py-4 gap-4"},st={__name:"ComposeDialog",emits:["close"],setup(M,{emit:z}){const f=D(""),V=D(""),y=D(""),A=D(""),I=D(""),h=D(!1),g=D(!1),C=()=>{f.value=A.value=I.value=""},d=ye({content:"",extensions:[$e,ke,Ce.configure({placeholder:"Message"}),we,be.configure({openOnClick:!1})]}),P=()=>{var c,a,m;const L=(c=d.value)==null?void 0:c.getAttributes("link").href,i=window.prompt("URL",L);if(i!==null){if(i===""){(a=d.value)==null||a.chain().focus().extendMarkRange("link").unsetLink().run();return}(m=d.value)==null||m.chain().focus().extendMarkRange("link").setLink({href:i}).run()}},_=()=>{var i;const L=window.prompt("URL");L&&((i=d.value)==null||i.chain().focus().setImage({src:L}).run())};return(L,i)=>{const c=se("IconBtn");return v(),B(ne,{class:"email-compose-dialog",elevation:"10","max-width":"30vw"},{default:t(()=>[e(Ne,{class:"py-3"},{append:t(()=>[e(c,{size:"small",onClick:i[0]||(i[0]=a=>L.$emit("close"))},{default:t(()=>[e(r,{icon:"ri-subtract-line"})]),_:1}),e(c,{size:"small",onClick:i[1]||(i[1]=a=>{L.$emit("close"),C()})},{default:t(()=>[e(r,{icon:"ri-close-line"})]),_:1})]),default:t(()=>[e(Oe,{class:"text-medium-emphasis"},{default:t(()=>[x(" Compose Mail ")]),_:1})]),_:1}),s("div",We,[e(X,{modelValue:l(f),"onUpdate:modelValue":i[4]||(i[4]=a=>J(f)?f.value=a:null),density:"compact"},{"prepend-inner":t(()=>[Ge]),append:t(()=>[s("span",Qe,[s("div",{onClick:i[2]||(i[2]=a=>h.value=!l(h))},"Cc"),Xe,s("div",{onClick:i[3]||(i[3]=a=>g.value=!l(g))},"Bcc")])]),_:1},8,["modelValue"])]),e(fe,null,{default:t(()=>[l(h)?(v(),b("div",Ye,[e(R),e(X,{modelValue:l(V),"onUpdate:modelValue":i[5]||(i[5]=a=>J(V)?V.value=a:null),density:"compact"},{"prepend-inner":t(()=>[Ze]),_:1},8,["modelValue"])])):q("",!0)]),_:1}),e(fe,null,{default:t(()=>[l(g)?(v(),b("div",et,[e(R),e(X,{modelValue:l(y),"onUpdate:modelValue":i[6]||(i[6]=a=>J(y)?y.value=a:null),density:"compact"},{"prepend-inner":t(()=>[tt]),_:1},8,["modelValue"])])):q("",!0)]),_:1}),e(R),e(X,{modelValue:l(A),"onUpdate:modelValue":i[7]||(i[7]=a=>J(A)?A.value=a:null),density:"compact"},{"prepend-inner":t(()=>[lt]),_:1},8,["modelValue"]),e(R),s("div",at,[l(d)?(v(),b("div",it,[e(c,{size:"small",rounded:"",color:l(d).isActive("bold")?"primary":"",variant:l(d).isActive("bold")?"tonal":"text",onClick:i[8]||(i[8]=a=>l(d).chain().focus().toggleBold().run())},{default:t(()=>[e(r,{icon:"ri-bold"})]),_:1},8,["color","variant"]),e(c,{size:"small",rounded:"",color:l(d).isActive("underline")?"primary":"",variant:l(d).isActive("underline")?"tonal":"text",onClick:i[9]||(i[9]=a=>l(d).commands.toggleUnderline())},{default:t(()=>[e(r,{icon:"ri-underline"})]),_:1},8,["color","variant"]),e(c,{size:"small",rounded:"",color:l(d).isActive("italic")?"primary":"",variant:l(d).isActive("italic")?"tonal":"text",onClick:i[10]||(i[10]=a=>l(d).chain().focus().toggleItalic().run())},{default:t(()=>[e(r,{icon:"ri-italic"})]),_:1},8,["color","variant"]),e(c,{size:"small",rounded:"",color:l(d).isActive("bulletList")?"primary":"",variant:l(d).isActive("bulletList")?"tonal":"text",onClick:i[11]||(i[11]=a=>l(d).chain().focus().toggleBulletList().run())},{default:t(()=>[e(r,{icon:"ri-list-check"})]),_:1},8,["color","variant"]),e(c,{size:"small",rounded:"",color:l(d).isActive("orderedList")?"primary":"",variant:l(d).isActive("orderedList")?"tonal":"text",onClick:i[12]||(i[12]=a=>l(d).chain().focus().toggleOrderedList().run())},{default:t(()=>[e(r,{icon:"ri-list-ordered-2"})]),_:1},8,["color","variant"]),e(c,{size:"small",rounded:"",onClick:P},{default:t(()=>[e(r,{icon:"ri-links-line"})]),_:1}),e(c,{size:"small",rounded:"",onClick:_},{default:t(()=>[e(r,{icon:"ri-image-line"})]),_:1})])):q("",!0),e(R),s("div",nt,[e(l(Ve),{editor:l(d)},null,8,["editor"])])]),s("div",ot,[e(ie,{"append-icon":"ri-send-plane-line"},{default:t(()=>[x(" Send "),e(Y,{activator:"parent"},{default:t(()=>[e(Z,null,{default:t(()=>[(v(),b(S,null,T(["Schedule Mail","Save Draft","Sent"],(a,m)=>e(ee,{key:m,value:m},{default:t(()=>[x($(a),1)]),_:2},1032,["value"])),64))]),_:1})]),_:1})]),_:1}),e(c,{size:"small"},{default:t(()=>[e(r,{icon:"ri-attachment-2"})]),_:1}),e(G),e(c,{size:"small"},{default:t(()=>[e(r,{icon:"ri-more-2-line"})]),_:1}),e(c,{size:"small",onClick:i[13]||(i[13]=a=>{L.$emit("close"),C()})},{default:t(()=>[e(r,{icon:"ri-delete-bin-7-line"})]),_:1})])]),_:1})}}},rt={class:"d-flex flex-column h-100"},dt={class:"pa-5"},ct={class:"email-filters-labels"},ut=["href","onClick"],mt={class:"text-base"},pt=s("li",{class:"text-sm d-block text-uppercase text-disabled mt-6 mb-3"}," LABELS ",-1),ft=["href","onClick"],vt={class:"text-body-1 text-high-emphasis d-inline-block"},gt=Object.assign({inheritAttrs:!1},{__name:"EmailLeftSidebarContent",emits:["toggleComposeDialogVisibility"],setup(M,{emit:z}){const f=[{title:"Inbox",prependIcon:"ri-mail-line",to:{name:"apps-email"},badge:{content:"21",color:"primary"}},{title:"Sent",prependIcon:"ri-send-plane-line",to:{name:"apps-email-filter",params:{filter:"sent"}}},{title:"Draft",prependIcon:"ri-edit-box-line",to:{name:"apps-email-filter",params:{filter:"draft"}},badge:{content:"2",color:"warning"}},{title:"Starred",prependIcon:"ri-star-line",to:{name:"apps-email-filter",params:{filter:"starred"}}},{title:"Spam",prependIcon:"ri-spam-2-line",to:{name:"apps-email-filter",params:{filter:"spam"}},badge:{content:"4",color:"error"}},{title:"Trash",prependIcon:"ri-delete-bin-7-line",to:{name:"apps-email-filter",params:{filter:"trashed"}}}],V=[{title:"Personal",color:"success",to:{name:"apps-email-label",params:{label:"personal"}}},{title:"Company",color:"primary",to:{name:"apps-email-label",params:{label:"company"}}},{title:"Important",color:"warning",to:{name:"apps-email-label",params:{label:"important"}}},{title:"Private",color:"error",to:{name:"apps-email-label",params:{label:"private"}}}];return(y,A)=>{const I=se("RouterLink");return v(),b("div",rt,[s("div",dt,[e(ie,{block:"",onClick:A[0]||(A[0]=h=>y.$emit("toggleComposeDialogVisibility"))},{default:t(()=>[x(" Compose ")]),_:1})]),e(l(ue),{options:{wheelPropagation:!1},class:"h-100 pt-4"},{default:t(()=>[s("ul",ct,[(v(),b(S,null,T(f,h=>e(I,{key:h.title,class:"d-flex align-center cursor-pointer",to:h.to,custom:""},{default:t(({isActive:g,href:C,navigate:d})=>{var P;return[s("li",ve({ref_for:!0},y.$attrs,{href:C,class:[g&&"email-filter-active text-primary","d-flex align-center cursor-pointer"],onClick:d}),[e(r,{icon:h.prependIcon,class:"me-2",size:"20"},null,8,["icon"]),s("span",mt,$(h.title),1),e(G),(P=h.badge)!=null&&P.content?(v(),B(me,{key:0,size:"x-small",variant:"tonal",inline:"",class:"v-badge--tonal badge-custom-padding",color:h.badge.color,content:h.badge.content},null,8,["color","content"])):q("",!0)],16,ut)]}),_:2},1032,["to"])),64)),pt,(v(),b(S,null,T(V,h=>e(I,{key:h.title,class:"d-flex align-center",to:h.to,custom:""},{default:t(({isActive:g,href:C,navigate:d})=>[s("li",ve({ref_for:!0},y.$attrs,{href:C,class:[g&&"email-label-active text-primary","cursor-pointer"],onClick:d}),[e(r,{color:h.color,icon:"ri-circle-fill",size:"12",class:"me-2"},null,8,["color"]),s("span",vt,$(h.title),1)],16,ft)]),_:2},1032,["to"])),64))])]),_:1})])}}}),ce=()=>{const M=he(),z=async(g,C)=>{await ge("apps/email",{method:"POST",body:JSON.stringify({ids:g,data:C})})};return{labels:[{title:"personal",color:"success"},{title:"company",color:"primary"},{title:"important",color:"warning"},{title:"private",color:"error"}],resolveLabelColor:g=>g==="personal"?"success":g==="company"?"primary":g==="important"?"warning":g==="private"?"error":"secondary",shallShowMoveToActionFor:g=>g==="trash"?M.params.filter!=="trashed":g==="inbox"?!(M.params.filter===void 0||M.params.filter==="sent"||M.params.filter==="draft"):g==="spam"?!(M.params.filter==="spam"||M.params.filter==="sent"||M.params.filter==="draft"):!1,emailMoveToFolderActions:[{action:"inbox",icon:"ri-mail-line"},{action:"spam",icon:"ri-spam-2-line"},{action:"trash",icon:"ri-delete-bin-line"}],moveSelectedEmailTo:async(g,C)=>{const d={};g==="inbox"?(M.params.filter==="trashed"&&(d.isDeleted=!1),d.folder="inbox"):g==="spam"?(M.params.filter==="trashed"&&(d.isDeleted=!1),d.folder="spam"):g==="trash"&&(d.isDeleted=!0),await z(C,d)},updateEmails:z,updateEmailLabels:async(g,C)=>{await ge("/apps/email",{method:"POST",body:{ids:g,label:C}})}}},_t={class:"email-view-header d-flex align-center px-5 py-4"},ht={class:"d-flex align-center flex-wrap flex-grow-1 overflow-hidden gap-2"},xt={class:"text-body-1 text-high-emphasis text-truncate"},kt={class:"d-flex flex-wrap gap-2"},bt={class:"d-flex align-center gap-2"},yt={class:"email-view-action-bar d-flex align-center text-medium-emphasis gap-1 px-5"},$t={class:"d-flex align-start"},Ct={class:"d-flex flex-wrap flex-grow-1 overflow-hidden"},wt={class:"text-truncate"},Vt={class:"text-h6 font-weight-regular text-truncate"},Lt={class:"text-body-2 mb-0"},Mt={class:"d-flex align-center"},St={class:"text-disabled me-4"},At=["innerHTML"],Et=s("span",null,"Attachments",-1),zt=s("h6",{class:"text-h6 font-weight-regular mb-6"}," Reply to Ross Geller ",-1),It={class:"tiptap-editor-wrapper"},Dt={key:0,class:"d-flex flex-wrap gap-x-2 mb-6"},Ut={class:"d-flex align-center justify-space-between justify-sm-end gap-4 mt-6 flex-wrap"},Rt={__name:"EmailView",props:{email:{type:null,required:!0},emailMeta:{type:Object,required:!0}},emits:["refresh","navigated","close","trash","unread","read","star","unstar"],setup(M,{emit:z}){const f=M,V=z,{updateEmailLabels:y}=ce(),{labels:A,resolveLabelColor:I,emailMoveToFolderActions:h,shallShowMoveToActionFor:g,moveSelectedEmailTo:C}=ce(),d=async c=>{await C(c,[f.email.id]),V("refresh"),V("close")},P=async c=>{await y([f.email.id],c),V("refresh")},_=ye({content:"",extensions:[$e,ke,Ce.configure({placeholder:"Write your message..."}),we,be.configure({openOnClick:!1})]}),L=()=>{var m,O,u;const c=(m=_.value)==null?void 0:m.getAttributes("link").href,a=window.prompt("URL",c);if(a!==null){if(a===""){(O=_.value)==null||O.chain().focus().extendMarkRange("link").unsetLink().run();return}(u=_.value)==null||u.chain().focus().extendMarkRange("link").setLink({href:a}).run()}},i=()=>{var a;const c=window.prompt("URL");c&&((a=_.value)==null||a.chain().focus().setImage({src:c}).run())};return(c,a)=>{const m=se("IconBtn"),O=xe;return v(),B(Me,{temporary:"","model-value":!!f.email,location:"right",scrim:!1,floating:"",class:"email-view"},{default:t(()=>[f.email?(v(),b(S,{key:0},[s("div",_t,[e(m,{class:"me-2 flip-in-rtl",onClick:a[0]||(a[0]=u=>c.$emit("close"))},{default:t(()=>[e(r,{icon:"ri-arrow-left-s-line"})]),_:1}),s("div",ht,[s("h6",xt,$(f.email.subject),1),s("div",kt,[(v(!0),b(S,null,T(f.email.labels,u=>(v(),B(Fe,{key:u,color:l(I)(u),size:"small",class:"text-capitalize flex-shrink-0"},{default:t(()=>[x($(u),1)]),_:2},1032,["color"]))),128))])]),s("div",bt,[e(m,{variant:"plain",disabled:!f.emailMeta.hasPreviousEmail,class:"flip-in-rtl",onClick:a[1]||(a[1]=u=>c.$emit("navigated","previous"))},{default:t(()=>[e(r,{icon:"ri-arrow-left-s-line"})]),_:1},8,["disabled"]),e(m,{variant:"plain",class:"flip-in-rtl",disabled:!f.emailMeta.hasNextEmail,onClick:a[2]||(a[2]=u=>c.$emit("navigated","next"))},{default:t(()=>[e(r,{icon:"ri-arrow-right-s-line"})]),_:1},8,["disabled"])])]),e(R),s("div",yt,[K(e(m,{onClick:a[3]||(a[3]=u=>{c.$emit("trash",f.email.id),c.$emit("close")})},{default:t(()=>[e(r,{icon:"ri-delete-bin-7-line"}),e(U,{activator:"parent",location:"top"},{default:t(()=>[x(" Delete Mail ")]),_:1})]),_:1},512),[[W,!f.email.isDeleted]]),e(m,{onClick:a[4]||(a[4]=j(u=>{c.$emit("unread"),c.$emit("close")},["stop"]))},{default:t(()=>[e(r,{icon:"ri-mail-line"}),e(U,{activator:"parent",location:"top"},{default:t(()=>[x(" Mark as Unread ")]),_:1})]),_:1}),e(m,null,{default:t(()=>[e(r,{icon:"ri-folder-line"}),e(U,{activator:"parent",location:"top"},{default:t(()=>[x(" Move to ")]),_:1}),e(Y,{activator:"parent"},{default:t(()=>[e(Z,{density:"compact"},{default:t(()=>[(v(!0),b(S,null,T(l(h),u=>(v(),B(ee,{key:u.title,class:ae([l(g)(u.action)?"d-flex":"d-none","align-center"]),href:"#",onClick:F=>d(u.action)},{prepend:t(()=>[e(r,{icon:u.icon,class:"me-2",size:"20"},null,8,["icon"])]),default:t(()=>[e(oe,{class:"text-capitalize"},{default:t(()=>[x($(u.action),1)]),_:2},1024)]),_:2},1032,["class","onClick"]))),128))]),_:1})]),_:1})]),_:1}),e(m,null,{default:t(()=>[e(r,{icon:"ri-price-tag-3-line"}),e(U,{activator:"parent",location:"top"},{default:t(()=>[x(" Label ")]),_:1}),e(Y,{activator:"parent"},{default:t(()=>[e(Z,{density:"compact"},{default:t(()=>[(v(!0),b(S,null,T(l(A),u=>(v(),B(ee,{key:u.title,href:"#",onClick:j(F=>P(u.title),["stop"])},{prepend:t(()=>[e(me,{inline:"",color:l(I)(u.title),dot:""},null,8,["color"])]),default:t(()=>[e(oe,{class:"ms-2 text-capitalize"},{default:t(()=>[x($(u.title),1)]),_:2},1024)]),_:2},1032,["onClick"]))),128))]),_:1})]),_:1})]),_:1}),e(G),e(m,{color:f.email.isStarred?"warning":"default",onClick:a[5]||(a[5]=u=>{var F;return(F=f.email)!=null&&F.isStarred?c.$emit("unstar"):c.$emit("star")})},{default:t(()=>[e(r,{icon:"ri-star-line"})]),_:1},8,["color"]),e(O)]),e(R),e(l(ue),{tag:"div",class:"mail-content-container flex-grow-1",options:{wheelPropagation:!1}},{default:t(()=>[e(ne,{class:"ma-6 mb-4"},{default:t(()=>[e(le,{class:"mail-header"},{default:t(()=>[s("div",$t,[e(Le,{size:"38",class:"me-4"},{default:t(()=>[e(de,{src:f.email.from.avatar,alt:f.email.from.name},null,8,["src","alt"])]),_:1}),s("div",Ct,[s("div",wt,[s("h6",Vt,$(f.email.from.name),1),s("p",Lt,$(f.email.from.email),1)]),e(G),s("div",Mt,[s("span",St,$(("formatDate"in c?c.formatDate:l(Ue))(f.email.time)),1),K(e(m,null,{default:t(()=>[e(r,{icon:"ri-attachment-2"})]),_:1},512),[[W,f.email.attachments.length]])])]),e(O,{class:"align-self-sm-center"})])]),_:1}),e(R),e(le,null,{default:t(()=>[s("div",{class:"text-base",innerHTML:f.email.message},null,8,At)]),_:1}),f.email.attachments.length?(v(),b(S,{key:0},[e(R),e(le,{class:"d-flex flex-column gap-y-4"},{default:t(()=>[Et,(v(!0),b(S,null,T(f.email.attachments,u=>(v(),b("div",{key:u.fileName,class:"d-flex align-center"},[e(de,{src:u.thumbnail,alt:u.fileName,"aspect-ratio":"1","max-height":"24","max-width":"24",class:"me-2"},null,8,["src","alt"]),s("span",null,$(u.fileName),1)]))),128))]),_:1})],64)):q("",!0)]),_:1}),e(ne,{class:"ma-6"},{default:t(()=>[e(le,null,{default:t(()=>[zt,s("div",It,[l(_)?(v(),b("div",Dt,[e(r,{icon:"ri-bold",color:l(_).isActive("bold")?"primary":"",size:"20",onClick:a[6]||(a[6]=u=>l(_).chain().focus().toggleBold().run())},null,8,["color"]),e(r,{color:l(_).isActive("underline")?"primary":"",icon:"ri-underline",size:"20",onClick:a[7]||(a[7]=u=>l(_).commands.toggleUnderline())},null,8,["color"]),e(r,{color:l(_).isActive("italic")?"primary":"",icon:"ri-italic",size:"20",onClick:a[8]||(a[8]=u=>l(_).chain().focus().toggleItalic().run())},null,8,["color"]),e(r,{color:l(_).isActive("bulletList")?"primary":"",icon:"ri-list-check",size:"20",onClick:a[9]||(a[9]=u=>l(_).chain().focus().toggleBulletList().run())},null,8,["color"]),e(r,{color:l(_).isActive("orderedList")?"primary":"",icon:"ri-list-ordered-2",size:"20",onClick:a[10]||(a[10]=u=>l(_).chain().focus().toggleOrderedList().run())},null,8,["color"]),e(r,{icon:"ri-links-line",size:"20",onClick:L}),e(r,{icon:"ri-image-line",size:"20",onClick:i})])):q("",!0),e(l(Ve),{editor:l(_)},null,8,["editor"])]),s("div",Ut,[e(ie,{color:"secondary",variant:"plain","prepend-icon":"ri-attachment-2"},{default:t(()=>[x(" Attachments ")]),_:1}),e(ie,{"append-icon":"ri-send-plane-line"},{default:t(()=>[x(" Send ")]),_:1})])]),_:1})]),_:1})]),_:1})],64)):q("",!0)]),_:1},8,["model-value"])}}},Tt={class:"d-flex align-center"},Bt={class:"py-2 px-4 d-flex align-center"},Pt=["onClick"],Nt={class:"text-h6"},Ot={class:"text-body-2 truncate"},Ft={class:"text-sm text-disabled"},jt={class:"email-actions d-none"},qt={class:"py-4 px-5 text-center"},Ht=s("span",{class:"text-high-emphasis"},"No items found.",-1),Jt=[Ht],Ul={__name:"index",async setup(M){let z,f;const{isLeftSidebarOpen:V}=je(),y=he(),{labels:A,resolveLabelColor:I,emailMoveToFolderActions:h,shallShowMoveToActionFor:g,moveSelectedEmailTo:C,updateEmails:d,updateEmailLabels:P}=ce(),_=D(!1),L=D(""),i=D([]),{data:c,execute:a}=([z,f]=Te(()=>Je(Ke("/apps/email",{query:{q:L,filter:()=>"filter"in y.params?y.params.filter:void 0,label:()=>"label"in y.params?y.params.label:void 0}}))),z=await z,f(),z),m=Q(()=>c.value.emails),O=p=>{const n=i.value.indexOf(p);n===-1?i.value.push(p):i.value.splice(n,1)},u=Q(()=>m.value.length&&m.value.length===i.value.length),F=Q(()=>!!i.value.length&&m.value.length!==i.value.length),re=Q(()=>i.value.every(p=>{var n;return(n=m.value.find(w=>w.id===p))==null?void 0:n.isRead})),Se=()=>{i.value=u.value?[]:m.value.map(p=>p.id)},k=D(null),Ae=Q(()=>{const p={hasNextEmail:!1,hasPreviousEmail:!1};if(k.value){const n=m.value.findIndex(w=>{var H;return w.id===((H=k.value)==null?void 0:H.id)});p.hasNextEmail=!!m.value[n+1],p.hasPreviousEmail=!!m.value[n-1]}return p}),pe=async()=>{await a(),k.value&&(k.value=m.value.find(p=>{var n;return p.id===((n=k.value)==null?void 0:n.id)}))},E=async(p,n=i.value)=>{i.value=[],n.length&&(p==="trash"?await d(n,{isDeleted:!0}):p==="spam"?await d(n,{folder:"spam"}):p==="unread"?await d(n,{isRead:!1}):p==="read"?await d(n,{isRead:!0}):p==="star"?await d(n,{isStarred:!0}):p==="unstar"&&await d(n,{isStarred:!1}),k.value?pe():await a())},Ee=async p=>{await C(p,i.value),await a()},ze=async p=>{await P(i.value,p),await a()},Ie=p=>{if(!k.value)return;const n=m.value.findIndex(H=>{var o;return H.id===((o=k.value)==null?void 0:o.id)}),w=p==="previous"?n-1:n+1;k.value=m.value[w]},De=async p=>{k.value=p,await E("read",[p.id])};return Be(()=>y.params,()=>{i.value=[]},{deep:!0}),(p,n)=>{const w=se("IconBtn"),H=xe;return v(),B(qe,{style:{"min-block-size":"100%"},class:"email-app-layout"},{default:t(()=>[e(Me,{modelValue:l(V),"onUpdate:modelValue":n[1]||(n[1]=o=>J(V)?V.value=o:null),absolute:"",touchless:"",location:"start",temporary:p.$vuetify.display.mdAndDown},{default:t(()=>[e(gt,{onToggleComposeDialogVisibility:n[0]||(n[0]=o=>_.value=!l(_))})]),_:1},8,["modelValue","temporary"]),e(Rt,{email:l(k),"email-meta":l(Ae),onRefresh:pe,onNavigated:Ie,onClose:n[2]||(n[2]=o=>k.value=null),onTrash:n[3]||(n[3]=o=>E("trash",l(k)?[l(k).id]:[])),onUnread:n[4]||(n[4]=o=>E("unread",l(k)?[l(k).id]:[])),onStar:n[5]||(n[5]=o=>E("star",l(k)?[l(k).id]:[])),onUnstar:n[6]||(n[6]=o=>E("unstar",l(k)?[l(k).id]:[]))},null,8,["email","email-meta"]),e(He,null,{default:t(()=>[e(ne,{flat:"",class:"email-content-list h-100 d-flex flex-column"},{default:t(()=>[s("div",Tt,[e(w,{class:"d-lg-none ms-3",onClick:n[7]||(n[7]=o=>V.value=!0)},{default:t(()=>[e(r,{icon:"ri-menu-line"})]),_:1}),e(X,{modelValue:l(L),"onUpdate:modelValue":n[8]||(n[8]=o=>J(L)?L.value=o:null),density:"default",class:"email-search px-1 flex-grow-1",placeholder:"Search mail"},{"prepend-inner":t(()=>[e(r,{color:"disabled",size:"22",icon:"ri-search-line",class:"me-2"})]),_:1},8,["modelValue"])]),e(R),s("div",Bt,[e(_e,{"model-value":l(u),indeterminate:l(F),class:"me-1","onUpdate:modelValue":Se},null,8,["model-value","indeterminate"]),s("div",{class:"w-100 d-flex align-center action-bar-actions gap-1",style:Pe({visibility:l(F)||l(u)?void 0:"hidden"})},[K(e(w,{onClick:n[9]||(n[9]=o=>E("trash"))},{default:t(()=>[e(r,{icon:"ri-delete-bin-7-line"}),e(U,{activator:"parent",location:"top"},{default:t(()=>[x(" Delete Mail ")]),_:1})]),_:1},512),[[W,"filter"in l(y).params?l(y).params.filter!=="trashed":!0]]),e(w,{onClick:n[10]||(n[10]=o=>l(re)?E("unread"):E("read"))},{default:t(()=>[e(r,{icon:l(re)?"ri-mail-line":"ri-mail-open-line"},null,8,["icon"]),e(U,{activator:"parent",location:"top"},{default:t(()=>[x($(l(re)?"Mark as Unread":"Mark as Read"),1)]),_:1})]),_:1}),e(w,null,{default:t(()=>[e(r,{icon:"ri-folder-line"}),e(U,{activator:"parent",location:"top"},{default:t(()=>[x(" Folder ")]),_:1}),e(Y,{activator:"parent"},{default:t(()=>[e(Z,{density:"compact"},{default:t(()=>[(v(!0),b(S,null,T(l(h),o=>(v(),B(ee,{key:o.title,class:ae([l(g)(o.action)?"d-flex":"d-none","align-center"]),href:"#",onClick:te=>Ee(o.action)},{prepend:t(()=>[e(r,{icon:o.icon,class:"me-2",size:"20"},null,8,["icon"])]),default:t(()=>[e(oe,{class:"text-capitalize"},{default:t(()=>[x($(o.action),1)]),_:2},1024)]),_:2},1032,["class","onClick"]))),128))]),_:1})]),_:1})]),_:1}),e(w,null,{default:t(()=>[e(r,{icon:"ri-price-tag-3-line"}),e(U,{activator:"parent",location:"top"},{default:t(()=>[x(" Label ")]),_:1}),e(Y,{activator:"parent"},{default:t(()=>[e(Z,{density:"compact"},{default:t(()=>[(v(!0),b(S,null,T(l(A),o=>(v(),B(ee,{key:o.title,href:"#",onClick:te=>ze(o.title)},{prepend:t(()=>[e(me,{inline:"",color:l(I)(o.title),dot:""},null,8,["color"])]),default:t(()=>[e(oe,{class:"ms-2 text-capitalize"},{default:t(()=>[x($(o.title),1)]),_:2},1024)]),_:2},1032,["onClick"]))),128))]),_:1})]),_:1})]),_:1})],4),e(G),e(w,{class:"me-1",onClick:l(a)},{default:t(()=>[e(r,{icon:"ri-refresh-line"})]),_:1},8,["onClick"]),e(H,{class:"text-medium-emphasis"})]),e(R),e(l(ue),{tag:"ul",options:{wheelPropagation:!1},class:"email-list"},{default:t(()=>[(v(!0),b(S,null,T(l(m),o=>{var te;return K((v(),b("li",{key:o.id,class:ae(["email-item d-flex align-center pa-4 gap-2 cursor-pointer",[{"email-read":o.isRead}]]),onClick:N=>De(o)},[e(_e,{"model-value":l(i).includes(o.id),class:"flex-shrink-0","onUpdate:modelValue":N=>O(o.id),onClick:n[11]||(n[11]=j(()=>{},["stop"]))},null,8,["model-value","onUpdate:modelValue"]),e(w,{color:o.isStarred?"warning":"default",onClick:j(N=>E(o.isStarred?"unstar":"star",[o.id]),["stop"])},{default:t(()=>[e(r,{icon:"ri-star-line"})]),_:2},1032,["color","onClick"]),e(Le,{size:"32"},{default:t(()=>[e(de,{src:o.from.avatar,alt:o.from.name},null,8,["src","alt"])]),_:2},1024),s("h6",Nt,$(o.from.name),1),s("span",Ot,$(o.subject),1),e(G),s("div",{class:ae(["email-meta align-center gap-2",p.$vuetify.display.xs?"d-none":""])},[(v(!0),b(S,null,T(o.labels,N=>(v(),B(r,{key:N,icon:"ri-circle-fill",size:"10",color:l(I)(N)},null,8,["color"]))),128)),s("span",Ft,$(("formatDateToMonthShort"in p?p.formatDateToMonthShort:l(Re))(o.time)),1)],2),s("div",jt,[e(w,{onClick:j(N=>E("trash",[o.id]),["stop"])},{default:t(()=>[e(r,{icon:"ri-delete-bin-7-line"}),e(U,{activator:"parent",location:"top"},{default:t(()=>[x(" Delete Mail ")]),_:1})]),_:2},1032,["onClick"]),e(w,{class:"mx-2",onClick:j(N=>E(o.isRead?"unread":"read",[o.id]),["stop"])},{default:t(()=>[e(r,{icon:o.isRead?"ri-mail-line":"ri-mail-open-line"},null,8,["icon"]),e(U,{activator:"parent",location:"top"},{default:t(()=>[x($(o.isRead?"Mark as Unread":"Mark as Read"),1)]),_:2},1024)]),_:2},1032,["onClick"]),e(w,{onClick:j(N=>E("spam",[o.id]),["stop"])},{default:t(()=>[e(r,{icon:"ri-error-warning-line"}),e(U,{activator:"parent",location:"top"},{default:t(()=>[x(" Move to Spam ")]),_:1})]),_:2},1032,["onClick"])])],10,Pt)),[[W,(te=l(m))==null?void 0:te.length]])}),128)),K(s("li",qt,Jt,512),[[W,!l(m).length]])]),_:1})]),_:1}),K(e(st,{onClose:n[12]||(n[12]=o=>_.value=!1)},null,512),[[W,l(_)]])]),_:1})]),_:1})}}};export{Ul as default};
